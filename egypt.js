const nigerianRecipes = [
    {
        name: "Ful Wa Ta’ameya (Egyptian Falafel)",
        image: "assets/egypt/falafel.jpg",
        description: "A traditional Egyptian dish made with fava beans and falafel.",
        ingredients: [
            "2 cups Dried fava beans",
            "1 Large onion, chopped",
            "4 cloves Garlic, minced",
            "1 cup Fresh parsley, chopped",
            "1 cup Fresh cilantro, chopped",
            "1 teaspoon Ground cumin",
            "1 teaspoon Ground coriander",
            "Salt to taste",
            "Vegetable oil for frying"
        ],
        instructions: [
            "Soak the fava beans overnight in plenty of water.",
            "Drain and rinse the beans, then blend them in a food processor until smooth.",
            "Add the onion, garlic, parsley, cilantro, cumin, coriander, and salt to the food processor and blend until well combined.",
            "Shape the mixture into small balls or patties.",
            "Heat the vegetable oil in a frying pan over medium heat.",
            "Fry the falafel until golden brown and crispy on all sides.",
            "Serve hot with pita bread, tahini sauce, and salad."
        ]
    },
    {
        name: "Ful Medames",
        image: "assets/egypt/ful.jpg",
        description: "A popular Egyptian dish made with slow-cooked fava beans.",
        ingredients: [
            "2 cups Dried fava beans",
            "1 Large onion, chopped",
            "4 cloves Garlic, minced",
            "1 Lemon, juiced",
            "1 teaspoon Ground cumin",
            "Salt to taste",
            "Olive oil for drizzling",
            "Fresh parsley, chopped (for garnish)"
        ],
        instructions: [
            "Soak the fava beans overnight in plenty of water.",
            "Drain and rinse the beans, then place them in a large pot.",
            "Add enough water to cover the beans and bring to a boil.",
            "Reduce the heat and simmer for about 2-3 hours, or until the beans are tender.",
            "In a separate pan, sauté the onion and garlic until golden brown.",
            "Add the onion and garlic to the beans, along with the lemon juice, cumin, and salt.",
            "Mash some of the beans to thicken the mixture.",
            "Serve hot, drizzled with olive oil and garnished with fresh parsley."
        ]
    },
    {
        name: "Koshari",
        image: "assets/egypt/koshari.jpg",
        description: "A popular Egyptian street food made with rice, lentils, and pasta, topped with a spicy tomato sauce.",
        ingredients: [
            "1 cup Rice",
            "1 cup Brown lentils",
            "1 cup Macaroni",
            "2 Large onions, sliced",
            "2 cups Tomato sauce",
            "4 cloves Garlic, minced",
            "1 teaspoon Ground cumin",
            "1 teaspoon Ground coriander",
            "1 teaspoon Chili powder",
            "Salt to taste",
            "Vegetable oil for frying"
        ],
        instructions: [
            "Cook the rice, lentils, and macaroni separately according to package instructions.",
            "In a large pan, heat the vegetable oil and fry the onions until golden brown and crispy. Set aside.",
            "In a separate pan, heat some oil and sauté the garlic until fragrant.",
            "Add the tomato sauce, cumin, coriander, chili powder, and salt, and simmer for about 10 minutes.",
            "To assemble, layer the rice, lentils, and macaroni on a plate.",
            "Top with the spicy tomato sauce and fried onions.",
            "Serve hot."
        ]
    },
    {
        name: "Hamam Mahshi (Stuffed Squab)",
        image: "assets/egypt/hamam.jpg",
        description: "A traditional Egyptian dish of stuffed squab (pigeon) with rice or bulgur wheat.",
        ingredients: [
            "2 Whole squabs (pigeons)",
            "1 cup Rice or bulgur wheat",
            "1 Large onion, chopped",
            "4 cloves Garlic, minced",
            "1 teaspoon Ground cinnamon",
            "1 teaspoon Ground allspice",
            "Salt and pepper to taste",
            "Butter or ghee for cooking"
        ],
        instructions: [
            "Rinse the squabs and pat them dry.",
            "In a pan, melt some butter or ghee and sauté the onion and garlic until golden brown.",
            "Add the rice or bulgur wheat, cinnamon, allspice, salt, and pepper, and cook for a few minutes until the grains are coated.",
            "Stuff the squabs with the rice or bulgur mixture.",
            "Tie the legs together to keep the stuffing inside.",
            "Place the squabs in a roasting pan and brush with melted butter or ghee.",
            "Roast in a preheated oven at 375°F (190°C) for about 45 minutes, or until the squabs are golden brown and cooked through.",
            "Serve hot with additional rice or bulgur on the side."
        ]
    },
    {
        name: "Fiteer Baladi (Egyptian Pizza)",
        image: "assets/egypt/feteer.jpg",
        description: "A flaky layered pastry often referred to as Egyptian pizza.",
        ingredients: [
            "2 cups All-purpose flour",
            "1 teaspoon Salt",
            "1 cup Warm water",
            "Butter or ghee for layering"
        ],
        instructions: [
            "In a large bowl, combine the flour and salt.",
            "Gradually add the warm water and mix to form a soft dough.",
            "Knead the dough on a floured surface for about 10 minutes until smooth and elastic.",
            "Cover the dough with a damp cloth and let it rest for at least 30 minutes.",
            "Divide the dough into small balls and roll each ball into a thin circle.",
            "Brush each circle with melted butter or ghee and fold it in half, then in half again to form a triangle.",
            "Roll out the triangle into a thin circle again and repeat the buttering and folding process several times to create layers.",
            "Place the layered dough on a baking sheet and bake in a preheated oven at 400°F (200°C) for about 20 minutes, or until golden brown and crispy.",
            "Serve hot with honey, cheese, or other toppings."
        ]
    },
    {
        name: "Shawarma",
        image: "assets/egypt/shawarma.jpg",
        description: "A popular Middle Eastern dish of marinated meat cooked on a vertical rotisserie and served in pita bread.",
        ingredients: [
            "500g Beef, lamb, or chicken, thinly sliced",
            "1 cup Yogurt",
            "4 cloves Garlic, minced",
            "1 tablespoon Ground cumin",
            "1 tablespoon Ground coriander",
            "1 teaspoon Ground turmeric",
            "1 teaspoon Ground paprika",
            "Salt and pepper to taste",
            "Pita bread for serving",
            "Tomatoes, cucumbers, and onions for garnish",
            "Tahini sauce or garlic sauce for serving"
        ],
        instructions: [
            "In a bowl, combine the yogurt, garlic, cumin, coriander, turmeric, paprika, salt, and pepper.",
            "Add the sliced meat to the marinade and mix well to coat.",
            "Cover and refrigerate for at least 2 hours, preferably overnight.",
            "Thread the marinated meat onto skewers and cook on a grill or in a hot pan until cooked through and slightly charred.",
            "Serve the shawarma in pita bread with tomatoes, cucumbers, onions, and tahini or garlic sauce."
        ]
    },
    {
        name: "Kofta and Kebab",
        image: "assets/egypt/kofta.jpg",
        description: "Grilled meat skewers made with spiced ground meat (kofta) or whole cuts of meat (kebab).",
        ingredients: [
            "500g Ground beef or lamb",
            "1 Large onion, grated",
            "4 cloves Garlic, minced",
            "1 cup Fresh parsley, chopped",
            "1 teaspoon Ground cumin",
            "1 teaspoon Ground coriander",
            "Salt and pepper to taste",
            "Skewers for grilling"
        ],
        instructions: [
            "In a bowl, combine the ground meat, grated onion, garlic, parsley, cumin, coriander, salt, and pepper.",
            "Mix well until all the ingredients are evenly distributed.",
            "Shape the mixture into long, thin cylinders around the skewers.",
            "Grill the kofta over medium-high heat, turning occasionally, until cooked through and slightly charred.",
            "Serve hot with pita bread, salad, and your favorite dipping sauces."
        ]
    },
    {
        name: "Basbousa",
        image: "assets/egypt/basbousa.jpg",
        description: "A traditional Egyptian semolina cake soaked in sweet syrup.",
        ingredients: [
            "2 cups Semolina",
            "1 cup Sugar",
            "1 cup Yogurt",
            "1/2 cup Butter, melted",
            "1 teaspoon Baking powder",
            "1 cup Water",
            "1 cup Sugar (for syrup)",
            "1 teaspoon Lemon juice",
            "Almonds for garnish"
        ],
        instructions: [
            "In a bowl, combine the semolina, sugar, yogurt, melted butter, and baking powder.",
            "Mix well to form a thick batter.",
            "Pour the batter into a greased baking dish and spread it evenly.",
            "Score the top of the batter into diamond shapes and place an almond in the center of each diamond.",
            "Bake in a preheated oven at 350°F (175°C) for about 30-40 minutes, or until golden brown.",
            "While the cake is baking, prepare the syrup by combining the water, sugar, and lemon juice in a saucepan.",
            "Bring to a boil, then reduce the heat and simmer for about 10 minutes.",
            "Pour the hot syrup over the baked cake and let it soak in.",
            "Allow the cake to cool completely before serving."
        ]
    },
    {
        name: "Baqlava",
        image: "assets/egypt/baqlawa.jpg",
        description: "A sweet pastry made of layers of filo dough filled with nuts and soaked in syrup.",
        ingredients: [
            "1 package Filo dough",
            "2 cups Mixed nuts (walnuts, pistachios, almonds), chopped",
            "1 cup Butter, melted",
            "1 cup Sugar",
            "1 cup Water",
            "1 teaspoon Lemon juice",
            "1 teaspoon Ground cinnamon"
        ],
        instructions: [
            "Preheat the oven to 350°F (175°C).",
            "In a bowl, combine the chopped nuts and ground cinnamon.",
            "Brush a baking dish with melted butter and layer several sheets of filo dough, brushing each sheet with butter.",
            "Sprinkle a layer of the nut mixture over the filo dough.",
            "Continue layering filo dough and nuts, brushing each layer with butter, until all the ingredients are used.",
            "Cut the assembled baqlawa into diamond or square shapes.",
            "Bake for about 30-40 minutes, or until golden brown and crisp.",
            "While the baqlawa is baking, prepare the syrup by combining the sugar, water, and lemon juice in a saucepan.",
            "Bring to a boil, then reduce the heat and simmer for about 10 minutes.",
            "Pour the hot syrup over the baked baqlawa and let it soak in.",
            "Allow the baqlawa to cool completely before serving."
        ]
    },
    {
        name: "Alexandria Cheese Fondue",
        image: "assets/egypt/alexandria.jpg",
        description: "A creamy cheese fondue from Alexandria, Egypt.",
        ingredients: [
            "2 cups Grated cheese (Cheddar, Gruyère, or a blend)",
            "1 cup Milk",
            "2 tablespoons All-purpose flour",
            "2 tablespoons Butter",
            "1 clove Garlic, minced",
            "1 teaspoon Ground black pepper",
            "Bread cubes or vegetables for dipping"
        ],
        instructions: [
            "In a saucepan, melt the butter over medium heat.",
            "Add the minced garlic and sauté until fragrant.",
            "Stir in the flour and cook for a minute to form a roux.",
            "Gradually whisk in the milk until smooth.",
            "Add the grated cheese and stir until melted and creamy.",
            "Season with ground black pepper.",
            "Transfer the cheese fondue to a fondue pot and keep warm over a low flame.",
            "Serve with bread cubes or vegetables for dipping."
        ]
    },
];
function generateRecipeHTML(recipe) {
    const recipeElement = document.createElement('div');
    recipeElement.className = 'recipe-container';
    recipeElement.innerHTML = `
        <div class="recipe-image-container">
            <img src="${recipe.image}" alt="${recipe.name}">
        </div>
        <div class="recipe-content">
            <h3>${recipe.name}</h3>
            <p>${recipe.description}</p>
            <button class="view-recipe-btn">View Recipe</button>
            <div class="recipe-details" style="display: none;">
                <h4>Ingredients:</h4>
                <ul>${recipe.ingredients.map(ing => `<li>${ing}</li>`).join('')}</ul>
                <h4>Instructions:</h4>
                <ol>${recipe.instructions.map(inst => `<li>${inst}</li>`).join('')}</ol>
                <button onclick="downloadRecipe('${recipe.name}')">Download Recipe as PDF</button>
            </div>
        </div>
    `;
    return recipeElement;
}

function downloadRecipe(recipeName) {
    const recipe = nigerianRecipes.find(r => r.name === recipeName);
    
    const { jsPDF } = window.jspdf;
    const doc = new jsPDF();

    // Set the title
    doc.setFontSize(24);
    doc.setTextColor(244, 164, 96); // A nice orange color
    doc.text(recipe.name, 105, 20, null, null, 'center');

    // Add the image
    try {
        const imgData = getBase64Image(recipe.image);
        doc.addImage(imgData, 'JPEG', 15, 30, 180, 100);
    } catch (error) {
        console.error('Error adding image to PDF:', error);
    }

    // Add ingredients
    doc.setFontSize(16);
    doc.setTextColor(0, 0, 0);
    doc.text('Ingredients:', 15, 140);

    doc.autoTable({
        startY: 145,
        head: [['Ingredients']],
        body: recipe.ingredients.map(ing => [ing]),
        theme: 'striped',
        headStyles: { fillColor: [244, 164, 96], textColor: 255 },
        margin: { left: 15, right: 15 },
    });

    // Add instructions
    let finalY = doc.lastAutoTable.finalY || 145;
    doc.setFontSize(16);
    doc.text('Instructions:', 15, finalY + 10);

    doc.autoTable({
        startY: finalY + 15,
        head: [['Step', 'Instruction']],
        body: recipe.instructions.map((inst, index) => [index + 1, inst]),
        theme: 'striped',
        headStyles: { fillColor: [244, 164, 96], textColor: 255 },
        margin: { left: 15, right: 15 },
    });

    doc.save(`${recipe.name}.pdf`);
}

function getBase64Image(imgUrl) {
    const img = new Image();
    img.crossOrigin = 'Anonymous';
    img.src = imgUrl;
    const canvas = document.createElement('canvas');
    canvas.width = img.width;
    canvas.height = img.height;
    const ctx = canvas.getContext('2d');
    ctx.drawImage(img, 0, 0);
    return canvas.toDataURL('image/jpeg');
}

document.addEventListener('DOMContentLoaded', () => {
    const recipesSection = document.getElementById('recipes');
    nigerianRecipes.forEach(recipe => {
        const recipeCard = generateRecipeHTML(recipe);
        recipesSection.appendChild(recipeCard);

        const viewRecipeBtn = recipeCard.querySelector('.view-recipe-btn');
        const recipeDetails = recipeCard.querySelector('.recipe-details');

        viewRecipeBtn.addEventListener('click', () => {
            if (recipeDetails.style.display === 'none') {
                recipeDetails.style.display = 'block';
                viewRecipeBtn.textContent = 'Hide Recipe';
            } else {
                recipeDetails.style.display = 'none';
                viewRecipeBtn.textContent = 'View Recipe';
            }
        });
    });
});