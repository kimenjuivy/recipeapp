const nigerianRecipes = [
    {
        name: "Jollof Rice",
        image: "assets/nigeria/jolof.jpg",
        description: "A popular West African dish made with rice, tomatoes, and various spices.",
        ingredients: [
            "500g Long grain rice",
            "3 cooking spoons Margarine / Vegetable oil",
            "2 Large Onions",
            "6 or more Red chilli peppers",
            "3 large Fresh tomatoes",
            "3 tablespoons Tomato purée",
            "1 clove Garlic / Ginger",
            "Bay leaves",
            "Thyme",
            "3 Maggi cubes",
            "500g Chicken",
            "100g Boiled seasoned snails",
            "40g Cooked green peas",
            "2 Smoked stock fish (optional)",
            "4 pieces of Crabs or 50g Shrimps",
            "A bunch of Plantain bananas",
            "500ml water"
        ],
        instructions: [
            "Melt the butter or pour 1 cooking spoon of vegetable oil in a deep cooking pan, add sliced onion till slightly brown, add grated garlic, tomato purée, sliced red chilli pepper and small grated ginger, stir all together, add other seasoning – leave to fry for 3mins then add water.",
            "Add the rice and bay leaf (optional) to above.",
            "In another cooking pan, boil the shrimps, crab, and snails together, add a bit of seasoning till cooked then add or separately boil green peas inside for 2mins.",
            "Season the chicken and grill with onions, a bit of garlic and ginger.",
            "Check the rice, if almost done, or bring to boil, add the shrimps, green peas either to garnish or to add to rice depending on you.",
            "Melt small cooking spoon of oil into frying pan, slice a bit of onion, chopped red chilli pepper, a little tomato purée, add the snail, crab, smoked stock fish and grilled chicken. Stir, add seasoning and fry for 10 minutes to make sauce.",
            "Check rice if well cooked. Softly stir up from the root with a wooden spoon because of the sauce settled at the bottom. If done, garnish with cooked and boiled green peas, fried plantain and the sauce. Serve with your favourite beverage."
        ]
    },
    {
        name: "EDIKAI IKONG WITH POUNDED YAM",
        image: "assets/nigeria/fufuf.jpg",
        description: "A hearty and nutritious African dish made with yam, assorted meats, and a variety of vegetables. Perfect for a comforting meal.",
        ingredients: [
            "1 tuber Yam",
            "400g Ugu/pumpkin leaves",
            "200g Waterleaves or Gure in Yoruba",
            "1kg boiled assorted meat",
            "200g Periwinkle",
            "200g boiled Dried Stock Fish (pre-soaked)",
            "4 pieces boiled Crabs and/or Snails",
            "100g Shrimps",
            "50g Crayfish",
            "300ml Palm oil",
            "1 large Onion",
            "1 large fresh tomato",
            "2 or 3 pieces red chilli peppers",
            "10g Locust beans",
            "Maggi and salt"
        ],
        instructions: [
            "Fry 3 or 4 cooking spoons of palm oil in a deep cooking pan, slice in a few onions.",
            "Add blended pepper and allow to cook for 3 minutes. Slice in red chilli peppers, tomatoes to add color and a little bit of chopped garlic (optional) then steam for 3 minutes.",
            "Add the sliced waterleaves; do not add water because waterleaves generate water on their own. Now cook for 3 minutes.",
            "Add remaining ingredients: periwinkle, shrimps, boiled stock fish, smoked stock fish, boiled assorted beef, crayfish, crabs, snails, and locust beans. Season with Maggi and salt. Stir all the ingredients together, then leave for 2 minutes.",
            "Add the Ugu, a bit of water then stir, leave for 2 minutes.",
            "Serve with Pounded yam."
        ]
    },
    {
        "name": "SUYA",
        "image": "assets/nigeria/suya.jpg",
        "description": "A spicy Nigerian street food made with skewered and grilled meat, typically beef or chicken, marinated in a blend of spices.",
        "ingredients": [
            "500g beef or chicken",
            "2 tablespoons groundnut (peanut) oil",
            "2 tablespoons Suya spice (Yaji)",
            "1 teaspoon salt",
            "1 large onion, sliced",
            "2 fresh tomatoes, sliced"
        ],
        "instructions": [
            "Cut the beef or chicken into thin, bite-sized pieces.",
            "In a bowl, mix the groundnut oil, Suya spice, and salt. Add the meat pieces and coat them well with the mixture. Let it marinate for at least 1 hour.",
            "Thread the meat onto skewers, ensuring the pieces are evenly spaced.",
            "Grill the skewers over medium heat, turning occasionally, until the meat is cooked through and slightly charred on the edges.",
            "Serve the Suya hot with sliced onions and tomatoes."
        ]
    },
    {
        "name": "FUFU AND OGBONO SOUP",
        "image": "assets/nigeria/ogbono.jpg",
        "description": "A traditional Nigerian dish where Fufu, a starchy side, is served with Ogbono Soup, a thick and hearty soup made from ground ogbono seeds.",
        "ingredients": [
            "2 cups cassava flour",
            "1 cup ground ogbono seeds",
            "200g assorted meats (beef, tripe, etc.)",
            "200g fish (stockfish or dried fish)",
            "1 cup spinach or bitterleaf",
            "1 cup palm oil",
            "2 tablespoons ground crayfish",
            "1 tablespoon ground pepper",
            "1 onion, chopped",
            "2 bouillon cubes",
            "Salt to taste"
        ],
        "instructions": [
            "To make the Fufu, mix the cassava flour with water in a pot. Stir continuously over medium heat until it forms a smooth, dough-like consistency. Set aside.",
            "In a pot, heat the palm oil and fry the chopped onions until translucent.",
            "Add the ground ogbono seeds and stir well to combine. Cook for a few minutes until it thickens.",
            "Add the assorted meats, fish, ground crayfish, and pepper. Pour in enough water to cover the ingredients and bring to a boil.",
            "Add the bouillon cubes and salt. Reduce the heat and let it simmer for about 30 minutes.",
            "Add the spinach or bitterleaf and cook for an additional 10 minutes.",
            "Serve the Ogbono Soup hot with Fufu."
        ]
    },
    {
        "name": "MOI MOI",
        "image": "assets/nigeria/moi moi.jpg",
        "description": "A steamed bean pudding made from blended black-eyed peas, peppers, onions, and spices. It can be served as a side dish or a main dish.",
        "ingredients": [
            "2 cups black-eyed peas",
            "1 large onion, chopped",
            "2 red bell peppers, chopped",
            "1-2 habanero peppers, chopped",
            "1/2 cup vegetable oil",
            "1 tablespoon ground crayfish",
            "2 bouillon cubes",
            "Salt to taste",
            "4 cups water",
            "Boiled eggs (optional)"
        ],
        "instructions": [
            "Soak the black-eyed peas in water for at least 4 hours, then peel off the skins.",
            "In a blender, combine the peeled black-eyed peas, onions, red bell peppers, and habanero peppers. Blend until smooth, adding water as needed to form a thick batter.",
            "Pour the batter into a large bowl. Add the vegetable oil, ground crayfish, bouillon cubes, and salt. Mix well to combine.",
            "Grease small ramekins or Moi Moi containers with oil. Pour the batter into the containers, filling them about three-quarters full. If using boiled eggs, place a piece in the center of each container.",
            "Steam the Moi Moi in a large pot with a rack or steamer insert. Add water to the pot, making sure it doesn't touch the containers. Cover the pot and steam for about 45 minutes to 1 hour, or until the Moi Moi is set and firm.",
            "Let the Moi Moi cool slightly before removing from the containers. Serve warm."
        ]
    },
    {
        name: "Pepper Soup",
        image: "assets/nigeria/pepper soup.png",
        description: "A spicy and flavorful Nigerian soup known for its healing properties.",
        ingredients: [
            "1 kg assorted meat (goat, beef, or chicken)",
            "2 tablespoons pepper soup spice mix",
            "2 tablespoons ground crayfish",
            "2 Maggi cubes",
            "1 medium onion, chopped",
            "2 cloves garlic, minced",
            "2 tablespoons ground uziza seeds (optional)",
            "Salt to taste",
            "Scotch bonnet pepper to taste",
            "4 cups water"
        ],
        instructions: [
            "Wash and cut the meat into bite-sized pieces.",
            "In a pot, combine the meat with chopped onions, minced garlic, pepper soup spice, crayfish, Maggi cubes, and salt.",
            "Add water and bring to a boil. Reduce heat and simmer for about 30 minutes or until the meat is tender.",
            "Add uziza seeds (if using) and scotch bonnet pepper. Simmer for another 10 minutes.",
            "Taste and adjust seasoning if needed.",
            "Serve hot as a starter or main course."
        ]
    },
    {
        name: "Ofada Rice and Stew",
        image: "assets/nigeria/ofada.png",
        description: "A flavorful combination of local rice and spicy stew, popular in Southwest Nigeria.",
        ingredients: [
            "2 cups Ofada rice",
            "500g assorted meat (beef, tripe, cow skin)",
            "200g locust beans (iru)",
            "6 large bell peppers",
            "4 scotch bonnet peppers",
            "2 large onions",
            "1/2 cup palm oil",
            "3 tablespoons ground crayfish",
            "2 Maggi cubes",
            "Salt to taste"
        ],
        instructions: [
            "Wash the Ofada rice thoroughly and cook until tender. Drain and set aside.",
            "Blend the bell peppers, scotch bonnet peppers, and one onion.",
            "Boil the assorted meat with salt and one chopped onion until tender. Reserve the stock.",
            "Heat palm oil in a pot until it bleaches (turns clear).",
            "Add chopped onions and locust beans, fry for 2 minutes.",
            "Pour in the blended pepper mix and fry for 15-20 minutes, stirring occasionally.",
            "Add the cooked meat, crayfish, Maggi cubes, and salt. Stir and simmer for 10 minutes.",
            "If needed, add some of the reserved meat stock to adjust consistency.",
            "Serve the Ofada rice with the stew on top or on the side."
        ]
    },
    {
        name: "Chin Chin",
        image: "assets/nigeria/chinn.jpg",
        description: "A popular Nigerian snack made from sweet, crunchy fried dough.",
        ingredients: [
            "4 cups all-purpose flour",
            "1/2 cup sugar",
            "1/4 cup butter, softened",
            "1/2 teaspoon baking powder",
            "1/4 teaspoon nutmeg",
            "1 egg",
            "1/2 cup milk",
            "Vegetable oil for frying",
            "Pinch of salt"
        ],
        instructions: [
            "In a large bowl, mix flour, sugar, baking powder, nutmeg, and salt.",
            "Add softened butter and mix until it resembles breadcrumbs.",
            "Beat the egg and milk together, then add to the flour mixture.",
            "Knead into a smooth dough. Cover and let rest for 15 minutes.",
            "Roll out the dough on a floured surface to about 1/4 inch thickness.",
            "Cut into small squares or desired shapes.",
            "Heat oil in a deep pan. Fry the chin chin in batches until golden brown.",
            "Drain on paper towels and let cool before serving."
        ]
    },
    {
        name: "Nigerian Fried Rice",
        image: "assets/nigeria/fried rice.jpg",
        description: "A colorful and tasty rice dish popular at parties and special occasions.",
        ingredients: [
            "3 cups long-grain rice",
            "500g mixed vegetables (carrots, peas, sweet corn)",
            "300g chicken or beef, diced",
            "3 eggs, beaten",
            "1 onion, chopped",
            "3 tablespoons vegetable oil",
            "2 Maggi cubes",
            "1 teaspoon thyme",
            "1 teaspoon curry powder",
            "Salt to taste"
        ],
        instructions: [
            "Cook the rice until tender, then drain and allow to cool.",
            "Season the diced meat with salt and cook until done. Set aside.",
            "Heat oil in a large pan or wok. Fry the chopped onions until translucent.",
            "Add the mixed vegetables and stir-fry for 3-4 minutes.",
            "Push the vegetables to one side of the pan and pour in the beaten eggs. Scramble the eggs.",
            "Add the cooked rice, meat, Maggi cubes, thyme, and curry powder. Stir well to combine.",
            "Fry for another 5-7 minutes, stirring occasionally.",
            "Taste and adjust seasoning if needed.",
            "Serve hot as a main dish or side."
        ]
    },
    {
        name: "Boli and Fish",
        image: "assets/nigeria/boli.jpg",
        description: "A popular street food consisting of roasted plantains and grilled fish.",
        ingredients: [
            "4 ripe plantains",
            "2 medium-sized tilapia fish",
            "2 tablespoons vegetable oil",
            "1 onion, sliced",
            "2 tomatoes, sliced",
            "2 scotch bonnet peppers",
            "Salt to taste",
            "1 tablespoon ground pepper"
        ],
        instructions: [
            "Clean the fish, make diagonal cuts on both sides, and season with salt and pepper.",
            "Peel the plantains and cut them in half lengthwise.",
            "Grill the plantains on a barbecue or grill pan until golden and soft. Set aside.",
            "Grill the fish on both sides until cooked through.",
            "In a pan, sauté the sliced onions, tomatoes, and scotch bonnet peppers with a little oil.",
            "Serve the grilled plantains (boli) with the fish, topped with the sautéed vegetables."
        ]
    },
    {
        name: "Nigerian Puff Puff",
        image: "assets/nigeria/puff.jpg",
        description: "A popular Nigerian street snack made of deep-fried dough balls.",
        ingredients: [
            "3 cups all-purpose flour",
            "2 teaspoons active dry yeast",
            "1/2 cup sugar",
            "1/2 teaspoon nutmeg (optional)",
            "1/4 teaspoon salt",
            "1 1/4 cups warm water",
            "Vegetable oil for frying"
        ],
        instructions: [
            "In a large bowl, mix flour, sugar, yeast, nutmeg, and salt.",
            "Gradually add warm water and mix until you have a smooth, sticky batter.",
            "Cover the bowl with a damp cloth and let the batter rise in a warm place for about 1 hour.",
            "Heat oil in a deep pan or pot for frying.",
            "Use your hand or a spoon to scoop small amounts of batter and drop into the hot oil.",
            "Fry until golden brown, turning occasionally to ensure even cooking.",
            "Remove with a slotted spoon and drain on paper towels.",
            "Serve warm as a snack or dessert."
        ]
    },
];

function generateRecipeHTML(recipe) {
    const recipeElement = document.createElement('div');
    recipeElement.className = 'recipe-container';
    recipeElement.innerHTML = `
        <div class="recipe-image-container">
            <img src="${recipe.image}" alt="${recipe.name}">
        </div>
        <div class="recipe-content">
            <h3>${recipe.name}</h3>
            <p>${recipe.description}</p>
            <button class="view-recipe-btn">View Recipe</button>
            <div class="recipe-details" style="display: none;">
                <h4>Ingredients:</h4>
                <ul>${recipe.ingredients.map(ing => `<li>${ing}</li>`).join('')}</ul>
                <h4>Instructions:</h4>
                <ol>${recipe.instructions.map(inst => `<li>${inst}</li>`).join('')}</ol>
                <button onclick="downloadRecipe('${recipe.name}')">Download Recipe as PDF</button>
            </div>
        </div>
    `;
    return recipeElement;
}

function downloadRecipe(recipeName) {
    const recipe = nigerianRecipes.find(r => r.name === recipeName);
    
    const { jsPDF } = window.jspdf;
    const doc = new jsPDF();

    // Set the title
    doc.setFontSize(24);
    doc.setTextColor(244, 164, 96); // A nice orange color
    doc.text(recipe.name, 105, 20, null, null, 'center');

    // Add the image
    try {
        const imgData = getBase64Image(recipe.image);
        doc.addImage(imgData, 'JPEG', 15, 30, 180, 100);
    } catch (error) {
        console.error('Error adding image to PDF:', error);
    }

    // Add ingredients
    doc.setFontSize(16);
    doc.setTextColor(0, 0, 0);
    doc.text('Ingredients:', 15, 140);

    doc.autoTable({
        startY: 145,
        head: [['Ingredients']],
        body: recipe.ingredients.map(ing => [ing]),
        theme: 'striped',
        headStyles: { fillColor: [244, 164, 96], textColor: 255 },
        margin: { left: 15, right: 15 },
    });

    // Add instructions
    let finalY = doc.lastAutoTable.finalY || 145;
    doc.setFontSize(16);
    doc.text('Instructions:', 15, finalY + 10);

    doc.autoTable({
        startY: finalY + 15,
        head: [['Step', 'Instruction']],
        body: recipe.instructions.map((inst, index) => [index + 1, inst]),
        theme: 'striped',
        headStyles: { fillColor: [244, 164, 96], textColor: 255 },
        margin: { left: 15, right: 15 },
    });

    doc.save(`${recipe.name}.pdf`);
}

function getBase64Image(imgUrl) {
    const img = new Image();
    img.crossOrigin = 'Anonymous';
    img.src = imgUrl;
    const canvas = document.createElement('canvas');
    canvas.width = img.width;
    canvas.height = img.height;
    const ctx = canvas.getContext('2d');
    ctx.drawImage(img, 0, 0);
    return canvas.toDataURL('image/jpeg');
}

document.addEventListener('DOMContentLoaded', () => {
    const recipesSection = document.getElementById('recipes');
    nigerianRecipes.forEach(recipe => {
        const recipeCard = generateRecipeHTML(recipe);
        recipesSection.appendChild(recipeCard);

        const viewRecipeBtn = recipeCard.querySelector('.view-recipe-btn');
        const recipeDetails = recipeCard.querySelector('.recipe-details');

        viewRecipeBtn.addEventListener('click', () => {
            if (recipeDetails.style.display === 'none') {
                recipeDetails.style.display = 'block';
                viewRecipeBtn.textContent = 'Hide Recipe';
            } else {
                recipeDetails.style.display = 'none';
                viewRecipeBtn.textContent = 'View Recipe';
            }
        });
    });
});