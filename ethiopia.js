const nigerianRecipes = [
    {
        name: "Kitfo",
        image: "assets/ethiopia/kifto.jpeg",
        description: "A traditional Ethiopian dish of minced raw beef, marinated in mitmita and niter kibbeh.",
        ingredients: [
            "500 g lean beef, minced",
            "2 tbsp mitmita (Ethiopian chili powder)",
            "100 g niter kibbeh (spiced clarified butter)",
            "1 tbsp ground cardamom",
            "Salt to taste",
            "Injera for serving"
        ],
        instructions: [
            "Melt the niter kibbeh in a pan.",
            "Add the mitmita, ground cardamom, and salt, and mix well.",
            "Remove from heat and stir in the minced beef until well coated.",
            "Serve immediately with injera."
        ]
    },
    {
        name: "Tibs",
        image: "assets/ethiopia/tibs.jpg",
        description: "A flavorful Ethiopian stir-fry made with beef or lamb, vegetables, and spices.",
        ingredients: [
            "500 g beef or lamb, cubed",
            "1 onion, sliced",
            "2 cloves garlic, minced",
            "2 tomatoes, chopped",
            "2 green peppers, sliced",
            "2 tbsp vegetable oil",
            "1 tbsp berbere spice",
            "Salt and pepper to taste",
            "Injera for serving"
        ],
        instructions: [
            "Heat the oil in a pan and sauté the onions and garlic until soft.",
            "Add the beef or lamb and cook until browned.",
            "Stir in the tomatoes, green peppers, and berbere spice.",
            "Season with salt and pepper and cook until the meat is tender.",
            "Serve hot with injera."
        ]
    },
    {
        name: "Beyainatu",
        image: "assets/ethiopia/beyainatu.jpg",
        description: "A colorful platter of various Ethiopian vegetarian dishes served with injera.",
        ingredients: [
            "Lentil stew (misir wot)",
            "Chickpea stew (shiro)",
            "Collard greens (gomen)",
            "Beetroot salad",
            "Cabbage and carrot stir-fry",
            "Injera for serving"
        ],
        instructions: [
            "Prepare each of the vegetarian dishes separately.",
            "Arrange portions of each dish on a large platter.",
            "Serve with injera."
        ]
    },
    {
        name: "Fuul",
        image: "assets/ethiopia/fuul.jpg",
        description: "A hearty Ethiopian breakfast dish made from fava beans, seasoned with spices and herbs.",
        ingredients: [
            "2 cups dried fava beans, soaked overnight",
            "1 onion, chopped",
            "2 cloves garlic, minced",
            "2 tbsp olive oil",
            "1 tsp ground cumin",
            "1 tsp ground coriander",
            "Salt and pepper to taste",
            "Chopped tomatoes, onions, and jalapeños for garnish",
            "Lemon wedges for serving"
        ],
        instructions: [
            "Drain and rinse the soaked fava beans.",
            "In a pot, heat the olive oil and sauté the onions and garlic until soft.",
            "Add the fava beans, cumin, coriander, salt, and pepper.",
            "Cover with water and simmer until the beans are tender.",
            "Mash the beans slightly with a fork.",
            "Serve with chopped tomatoes, onions, jalapeños, and lemon wedges."
        ]
    },

    {
    name: "Tere Siga",
    image: "assets/ethiopia/tere_siga.jpg",
    description: "Raw beef cubes served with dipping sauces and Ethiopian bread.",
    ingredients: [
        "500 g lean beef, cubed",
        "Mitmita (Ethiopian chili powder)",
        "Niter kibbeh (spiced clarified butter)",
        "Ethiopian mustard",
        "Injera for serving"
    ],
    instructions: [
        "Cut the beef into small cubes.",
        "Serve raw beef cubes with sides of mitmita, niter kibbeh, and Ethiopian mustard.",
        "Eat with injera."
    ]
}, 
{
    name: "Doro Wot",
    image: "assets/ethiopia/doro_wot.jpg",
    description: "A spicy Ethiopian chicken stew made with berbere spice and hard-boiled eggs.",
    ingredients: [
        "1 whole chicken, cut into pieces",
        "4 hard-boiled eggs, peeled",
        "2 large onions, finely chopped",
        "3 cloves garlic, minced",
        "1 tbsp ginger, minced",
        "3 tbsp berbere spice",
        "1 cup niter kibbeh (spiced clarified butter)",
        "1 cup chicken broth",
        "Salt to taste",
        "Injera for serving"
    ],
    instructions: [
        "In a large pot, melt the niter kibbeh and sauté the onions until caramelized.",
        "Add the garlic, ginger, and berbere spice, and cook for a few minutes.",
        "Add the chicken pieces and cook until browned.",
        "Pour in the chicken broth and simmer until the chicken is tender.",
        "Add the hard-boiled eggs and simmer for another 10 minutes.",
        "Serve hot with injera."
    ]
},
{
    name: "Enkulal Firfir",
    image: "assets/ethiopia/enkulal_firfir.jpeg",
    description: "Scrambled eggs mixed with pieces of injera and seasoned with spices.",
    ingredients: [
        "6 eggs, beaten",
        "1 onion, chopped",
        "2 green peppers, chopped",
        "2 tomatoes, chopped",
        "2 tbsp vegetable oil",
        "Salt and pepper to taste",
        "Pieces of injera",
        "Berbere spice to taste"
    ],
    instructions: [
        "Heat the oil in a pan and sauté the onions until soft.",
        "Add the green peppers and tomatoes, and cook until tender.",
        "Stir in the beaten eggs and cook until scrambled.",
        "Add the pieces of injera and berbere spice, and mix well.",
        "Season with salt and pepper.",
        "Serve hot."
    ]
},
{
    name: "Dulet",
    image: "assets/ethiopia/dulet.jpg",
    description: "A spicy mixture of minced tripe, liver, and lean beef, seasoned with spices.",
    ingredients: [
        "300 g tripe, cleaned and minced",
        "200 g liver, minced",
        "200 g lean beef, minced",
        "1 onion, chopped",
        "2 cloves garlic, minced",
        "2 green peppers, chopped",
        "2 tbsp vegetable oil",
        "2 tbsp berbere spice",
        "Salt and pepper to taste",
        "Injera for serving"
    ],
    instructions: [
        "Heat the oil in a pan and sauté the onions and garlic until soft.",
        "Add the tripe, liver, and beef, and cook until browned.",
        "Stir in the green peppers and berbere spice.",
        "Season with salt and pepper and cook until everything is well combined.",
        "Serve hot with injera."
    ]
},
{
    name: "Shiro",
    image: "assets/ethiopia/shiro.jpg",
    description: "A thick stew made from ground chickpeas or broad beans, seasoned with spices.",
    ingredients: [
        "1 cup shiro powder (ground chickpeas or broad beans)",
        "2 onions, finely chopped",
        "3 cloves garlic, minced",
        "1 tbsp ginger, minced",
        "3 tbsp vegetable oil",
        "2 tbsp berbere spice",
        "4 cups water or broth",
        "Salt to taste",
        "Injera for serving"
    ],
    instructions: [
        "Heat the oil in a pot and sauté the onions until soft.",
        "Add the garlic, ginger, and berbere spice, and cook for a few minutes.",
        "Stir in the shiro powder and cook for another minute.",
        "Gradually add the water or broth, stirring constantly to avoid lumps.",
        "Simmer until the stew thickens.",
        "Season with salt.",
        "Serve hot with injera."
    ]
},
{
    name: "Tihilo",
    image: "assets/ethiopia/tihilo.jpg",
    description: "A traditional Ethiopian dish made from roasted barley flour mixed with spices and butter.",
    ingredients: [
        "2 cups roasted barley flour",
        "1/2 cup niter kibbeh (spiced clarified butter)",
        "1 tbsp berbere spice",
        "1/2 cup water",
        "Salt to taste",
        "Injera for serving"
    ],
    instructions: [
        "In a bowl, mix the roasted barley flour with the berbere spice and salt.",
        "Gradually add the water, mixing to form a thick dough.",
        "Melt the niter kibbeh in a pan.",
        "Add the dough to the pan and cook, stirring constantly, until well combined.",
        "Serve hot with injera."
    ]
},
{
    name: "Fatira",
    image: "assets/ethiopia/fatira.jpg",
    description: "A traditional Ethiopian flatbread, often served with honey or savory toppings.",
    ingredients: [
        "2 cups all-purpose flour",
        "1 tsp baking powder",
        "1/2 tsp salt",
        "1/2 cup butter, melted",
        "1/2 cup water",
        "Honey or savory toppings (e.g., lentils, vegetables) for serving"
    ],
    instructions: [
        "In a bowl, mix the flour, baking powder, and salt.",
        "Gradually add the melted butter and water, mixing until a dough forms.",
        "Knead the dough until smooth, then cover and let rest for 30 minutes.",
        "Divide the dough into small balls and roll out each ball into a thin circle.",
        "Heat a pan over medium heat and cook each flatbread until golden brown on both sides.",
        "Serve hot with honey or savory toppings."
    ]
},
{
    name: "Asa",
    image: "assets/ethiopia/asa.jpg",
    description: "Ethiopian-style grilled fish seasoned with spices and served with injera.",
    ingredients: [
        "1 kg fish fillets (such as tilapia or Nile perch)",
        "2 onions, chopped",
        "3 cloves garlic, minced",
        "2 tomatoes, chopped",
        "2 tbsp vegetable oil",
        "1 tbsp berbere spice",
        "Salt and pepper to taste",
        "Injera for serving"
    ],
    instructions: [
        "In a bowl, mix the fish fillets with the vegetable oil, garlic, and berbere spice.",
        "Marinate for at least 30 minutes.",
        "Heat a grill or grill pan over medium-high heat.",
        "Grill the fish fillets for about 5-7 minutes on each side, or until cooked through.",
        "In a separate pan, sauté the onions and tomatoes until softened.",
        "Serve the grilled fish hot with the sautéed onions, tomatoes, and injera."
    ]
}   
];
function generateRecipeHTML(recipe) {
    const recipeElement = document.createElement('div');
    recipeElement.className = 'recipe-container';
    recipeElement.innerHTML = `
        <div class="recipe-image-container">
            <img src="${recipe.image}" alt="${recipe.name}">
        </div>
        <div class="recipe-content">
            <h3>${recipe.name}</h3>
            <p>${recipe.description}</p>
            <button class="view-recipe-btn">View Recipe</button>
            <div class="recipe-details" style="display: none;">
                <h4>Ingredients:</h4>
                <ul>${recipe.ingredients.map(ing => `<li>${ing}</li>`).join('')}</ul>
                <h4>Instructions:</h4>
                <ol>${recipe.instructions.map(inst => `<li>${inst}</li>`).join('')}</ol>
                <button onclick="downloadRecipe('${recipe.name}')">Download Recipe as PDF</button>
            </div>
        </div>
    `;
    return recipeElement;
}

function downloadRecipe(recipeName) {
    const recipe = nigerianRecipes.find(r => r.name === recipeName);
    
    const { jsPDF } = window.jspdf;
    const doc = new jsPDF();

    // Set the title
    doc.setFontSize(24);
    doc.setTextColor(244, 164, 96); // A nice orange color
    doc.text(recipe.name, 105, 20, null, null, 'center');

    // Add the image
    try {
        const imgData = getBase64Image(recipe.image);
        doc.addImage(imgData, 'JPEG', 15, 30, 180, 100);
    } catch (error) {
        console.error('Error adding image to PDF:', error);
    }

    // Add ingredients
    doc.setFontSize(16);
    doc.setTextColor(0, 0, 0);
    doc.text('Ingredients:', 15, 140);

    doc.autoTable({
        startY: 145,
        head: [['Ingredients']],
        body: recipe.ingredients.map(ing => [ing]),
        theme: 'striped',
        headStyles: { fillColor: [244, 164, 96], textColor: 255 },
        margin: { left: 15, right: 15 },
    });

    // Add instructions
    let finalY = doc.lastAutoTable.finalY || 145;
    doc.setFontSize(16);
    doc.text('Instructions:', 15, finalY + 10);

    doc.autoTable({
        startY: finalY + 15,
        head: [['Step', 'Instruction']],
        body: recipe.instructions.map((inst, index) => [index + 1, inst]),
        theme: 'striped',
        headStyles: { fillColor: [244, 164, 96], textColor: 255 },
        margin: { left: 15, right: 15 },
    });

    doc.save(`${recipe.name}.pdf`);
}

function getBase64Image(imgUrl) {
    const img = new Image();
    img.crossOrigin = 'Anonymous';
    img.src = imgUrl;
    const canvas = document.createElement('canvas');
    canvas.width = img.width;
    canvas.height = img.height;
    const ctx = canvas.getContext('2d');
    ctx.drawImage(img, 0, 0);
    return canvas.toDataURL('image/jpeg');
}

document.addEventListener('DOMContentLoaded', () => {
    const recipesSection = document.getElementById('recipes');
    nigerianRecipes.forEach(recipe => {
        const recipeCard = generateRecipeHTML(recipe);
        recipesSection.appendChild(recipeCard);

        const viewRecipeBtn = recipeCard.querySelector('.view-recipe-btn');
        const recipeDetails = recipeCard.querySelector('.recipe-details');

        viewRecipeBtn.addEventListener('click', () => {
            if (recipeDetails.style.display === 'none') {
                recipeDetails.style.display = 'block';
                viewRecipeBtn.textContent = 'Hide Recipe';
            } else {
                recipeDetails.style.display = 'none';
                viewRecipeBtn.textContent = 'View Recipe';
            }
        });
    });
});