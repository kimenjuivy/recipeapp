const nigerianRecipes = [
    {
        "name": "Mukimo",
        "image": "assets/kenya/mukimo.jpg",
        "description": "A traditional Kenyan dish made from mashed potatoes, green peas, maize, and pumpkin leaves.",
        "ingredients": [
            "1 kg Potatoes, peeled and chopped",
            "1 cup Green peas",
            "1 cup Maize kernels",
            "2 cups Pumpkin leaves (or spinach), chopped",
            "Salt to taste",
            "Water for boiling"
        ],
        "instructions": [
            "In a large pot, boil the potatoes, green peas, and maize together with enough water to cover them until soft, about 20-25 minutes.",
            "Add the chopped pumpkin leaves or spinach to the pot and cook for an additional 5 minutes.",
            "Drain any excess water and mash the mixture until smooth.",
            "Season with salt to taste and serve hot."
        ]
    }, 
    {
        "name": "Matoke",
        "image": "assets/kenya/matoke.jpg",
        "description": "A popular East African dish made with green bananas cooked with onions, tomatoes, and spices.",
        "ingredients": [
            "8 Green bananas (matoke), peeled and chopped",
            "2 tablespoons Vegetable oil",
            "1 Large onion, finely chopped",
            "2 Garlic cloves, minced",
            "1 inch Ginger, minced",
            "2 Large tomatoes, chopped",
            "1 Green bell pepper, chopped",
            "1 teaspoon Turmeric powder",
            "Salt to taste",
            "Water for cooking"
        ],
        "instructions": [
            "Heat the vegetable oil in a large pot over medium heat. Add the onions, garlic, and ginger, and saut√© until fragrant and golden brown.",
            "Add the tomatoes and bell pepper, and cook until the tomatoes are soft.",
            "Stir in the turmeric powder and cook for another minute.",
            "Add the chopped green bananas and enough water to cover them. Season with salt to taste.",
            "Bring to a boil, then reduce the heat and simmer until the bananas are tender, about 20-30 minutes.",
            "Mash the bananas slightly to thicken the dish and serve hot."
        ]
    },
    {
        "name": "Viazi Karai",
        "image": "assets/kenya/viazi.png",
        "description": "A popular Kenyan street food made from potatoes dipped in a spiced batter and deep-fried until golden brown.",
        "ingredients": [
            "1 kg Potatoes, boiled and peeled",
            "1 cup Gram flour (besan)",
            "1 teaspoon Turmeric powder",
            "1 teaspoon Chili powder",
            "Salt to taste",
            "Water to make batter",
            "Vegetable oil for deep frying"
        ],
        "instructions": [
            "Cut the boiled potatoes into bite-sized pieces.",
            "In a bowl, mix the gram flour, turmeric powder, chili powder, and salt. Add water gradually to make a thick batter.",
            "Heat the vegetable oil in a deep frying pan over medium-high heat.",
            "Dip the potato pieces into the batter, ensuring they are well-coated.",
            "Deep fry the coated potatoes until golden brown and crispy. Drain on paper towels and serve hot with chutney or ketchup."
        ]
    },
    {
        "name": "Nyama Choma",
        "image": "assets/kenya/nyama.jpg",
        "description": "Kenya's beloved roasted meat, often goat or beef, marinated in spices and grilled to perfection.",
        "ingredients": [
            "1 kg Goat or beef, cut into chunks",
            "2 tablespoons Vegetable oil",
            "1 tablespoon Garlic, minced",
            "1 tablespoon Ginger, minced",
            "1 tablespoon Paprika",
            "1 teaspoon Black pepper",
            "Salt to taste",
            "Juice of 1 lemon"
        ],
        "instructions": [
            "In a bowl, mix the vegetable oil, garlic, ginger, paprika, black pepper, salt, and lemon juice to make a marinade.",
            "Add the meat chunks to the marinade, ensuring they are well-coated. Let it marinate for at least 2 hours, or overnight for best results.",
            "Preheat a grill to medium-high heat.",
            "Grill the marinated meat until cooked to your desired level of doneness, turning occasionally to ensure even cooking.",
            "Serve hot with kachumbari (a fresh tomato and onion salad) and ugali."
        ]
    },
    {
        "name": "Ugali",
        "image": "assets/kenya/ugali.jpg",
        "description": "A staple Kenyan side dish made from maize flour cooked with water to a dough-like consistency.",
        "ingredients": [
            "2 cups Maize flour (cornmeal)",
            "4 cups Water",
            "Salt to taste (optional)"
        ],
        "instructions": [
            "Bring the water to a boil in a large pot.",
            "Gradually add the maize flour to the boiling water, stirring continuously to avoid lumps.",
            "Reduce the heat to low and continue to stir until the mixture thickens and pulls away from the sides of the pot, about 10-15 minutes.",
            "Cover and let it cook for an additional 5 minutes.",
            "Turn the ugali onto a plate, shape it into a mound, and serve hot."
        ]
    },
    {
        "name": "Fish Biriyani",
        "image": "assets/kenya/fisfb.jpg",
        "description": "A flavorful rice dish with marinated fish, spices, and herbs, popular along the Kenyan coast.",
        "ingredients": [
            "500g Fish fillets, cut into pieces",
            "2 cups Basmati rice",
            "2 Onions, sliced",
            "2 Tomatoes, chopped",
            "1 cup Yogurt",
            "2 tablespoons Ginger-garlic paste",
            "1 teaspoon Turmeric powder",
            "1 teaspoon Cumin powder",
            "1 teaspoon Coriander powder",
            "1 teaspoon Garam masala",
            "1 teaspoon Red chili powder",
            "Salt to taste",
            "4 cups Water",
            "3 tablespoons Vegetable oil",
            "Fresh coriander leaves for garnish"
        ],
        "instructions": [
            "Marinate the fish pieces with yogurt, ginger-garlic paste, turmeric powder, cumin powder, coriander powder, garam masala, red chili powder, and salt. Let it sit for at least 30 minutes.",
            "Rinse the rice under cold water until the water runs clear. Soak the rice in water for 30 minutes, then drain.",
            "Heat the vegetable oil in a large pot over medium heat. Add the sliced onions and cook until golden brown.",
            "Add the chopped tomatoes and cook until they soften.",
            "Add the marinated fish to the pot and cook until the fish is partially cooked, about 5 minutes.",
            "Add the drained rice and 4 cups of water. Bring to a boil, then reduce the heat to low.",
            "Cover the pot and let it simmer until the rice is fully cooked and the water is absorbed, about 15-20 minutes.",
            "Garnish with fresh coriander leaves and serve hot."
        ]
    },
    {
        "name": "Wali wa Nazi",
        "image": "assets/kenya/wali.jpg",
        "description": "A fragrant and creamy coconut rice dish from the coastal regions of Kenya.",
        "ingredients": [
            "2 cups Basmati rice",
            "2 cups Coconut milk",
            "2 cups Water",
            "1 Onion, finely chopped",
            "2 tablespoons Vegetable oil",
            "Salt to taste"
        ],
        "instructions": [
            "Rinse the rice under cold water until the water runs clear. Soak the rice in water for 30 minutes, then drain.",
            "Heat the vegetable oil in a large pot over medium heat. Add the chopped onion and cook until soft and translucent.",
            "Add the drained rice to the pot and stir to coat the rice with the oil and onions.",
            "Add the coconut milk, water, and salt to the pot. Stir to combine.",
            "Bring to a boil, then reduce the heat to low. Cover the pot and let it simmer until the rice is fully cooked and the liquid is absorbed, about 15-20 minutes.",
            "Fluff the rice with a fork and serve hot."
        ]
    },
    
    {
        name: "Chapati",
        image: "assets/kenya/chapati.png",
        description: "A type of flatbread commonly served with various dishes in Kenya.",
        ingredients: [
            "2 cups All-purpose flour",
            "1 cup Warm water",
            "1 teaspoon Salt",
            "2 tablespoons Vegetable oil"
        ],
        instructions: [
            "In a large bowl, combine the flour and salt.",
            "Gradually add the warm water and mix to form a soft dough.",
            "Knead the dough on a floured surface for about 10 minutes until smooth and elastic.",
            "Cover the dough with a damp cloth and let it rest for at least 30 minutes.",
            "Divide the dough into equal portions and roll each portion into a ball.",
            "On a floured surface, roll each ball into a thin circle.",
            "Heat a frying pan over medium heat and cook each chapati for about 2 minutes on each side, brushing with oil, until golden brown and slightly puffed.",
            "Serve hot with your favorite curry or stew."
        ]
    },
    {
        name: "Githeri",
        image: "assets/kenya/githeri.jpg",
        description: "A traditional Kenyan dish made with boiled maize and beans.",
        ingredients: [
            "2 cups Dried maize (corn kernels)",
            "2 cups Dried red beans",
            "1 Large onion, chopped",
            "2 Tomatoes, chopped",
            "2 tablespoons Vegetable oil",
            "Salt to taste",
            "1 teaspoon Curry powder (optional)"
        ],
        instructions: [
            "Soak the maize and beans overnight in separate bowls.",
            "Drain and rinse the maize and beans, then combine them in a large pot.",
            "Add enough water to cover the maize and beans and bring to a boil.",
            "Reduce the heat and simmer for about 1-2 hours, or until the maize and beans are tender.",
            "In a separate pan, heat the vegetable oil and saut√© the onions until golden brown.",
            "Add the tomatoes and cook until softened.",
            "Add the cooked maize and beans to the onion and tomato mixture, stirring to combine.",
            "Season with salt and curry powder (if using).",
            "Serve hot as a main dish or side."
        ]
    },
    {
        name: "Kenyan Pilau",
        image: "assets/kenya/pilau.jpg",
        description: "A flavorful rice dish cooked with meat, spices, and aromatics.",
        ingredients: [
            "2 cups Basmati rice",
            "500g Beef or chicken, cut into cubes",
            "2 Large onions, chopped",
            "3 Tomatoes, chopped",
            "4 Garlic cloves, minced",
            "1 tablespoon Ginger, minced",
            "2 tablespoons Pilau masala",
            "2 cups Beef or chicken broth",
            "2 tablespoons Vegetable oil",
            "Salt to taste"
        ],
        instructions: [
            "In a large pot, heat the vegetable oil over medium heat.",
            "Add the onions and cook until golden brown.",
            "Add the garlic, ginger, and pilau masala, and cook for a few minutes until fragrant.",
            "Add the meat and cook until browned.",
            "Stir in the tomatoes and cook until softened.",
            "Add the rice and stir to coat with the spices and oil.",
            "Pour in the broth and bring to a boil.",
            "Reduce the heat to low, cover, and simmer for about 20 minutes, or until the rice is cooked and the liquid is absorbed.",
            "Fluff the rice with a fork and serve hot."
        ]
    },
    {
        name: "Sukuma Wiki",
        image: "assets/kenya/wiki.jpg",
        description: "A popular Kenyan side dish made with collard greens saut√©ed with onions and tomatoes.",
        ingredients: [
            "1 bunch Collard greens (sukuma wiki), chopped",
            "1 Large onion, chopped",
            "2 Tomatoes, chopped",
            "2 tablespoons Vegetable oil",
            "Salt to taste",
            "1 teaspoon Garlic, minced (optional)"
        ],
        instructions: [
            "Heat the vegetable oil in a large pan over medium heat.",
            "Add the onions and cook until golden brown.",
            "Add the tomatoes and cook until softened.",
            "Stir in the garlic (if using) and cook for a minute.",
            "Add the collard greens and cook, stirring occasionally, until wilted and tender.",
            "Season with salt to taste.",
            "Serve hot as a side dish with ugali or rice."
        ]
    },
];
function generateRecipeHTML(recipe) {
    const recipeElement = document.createElement('div');
    recipeElement.className = 'recipe-container';
    recipeElement.innerHTML = `
        <div class="recipe-image-container">
            <img src="${recipe.image}" alt="${recipe.name}">
        </div>
        <div class="recipe-content">
            <h3>${recipe.name}</h3>
            <p>${recipe.description}</p>
            <button class="view-recipe-btn">View Recipe</button>
            <div class="recipe-details" style="display: none;">
                <h4>Ingredients:</h4>
                <ul>${recipe.ingredients.map(ing => `<li>${ing}</li>`).join('')}</ul>
                <h4>Instructions:</h4>
                <ol>${recipe.instructions.map(inst => `<li>${inst}</li>`).join('')}</ol>
                <button onclick="downloadRecipe('${recipe.name}')">Download Recipe as PDF</button>
            </div>
        </div>
    `;
    return recipeElement;
}

function downloadRecipe(recipeName) {
    const recipe = nigerianRecipes.find(r => r.name === recipeName);
    
    const { jsPDF } = window.jspdf;
    const doc = new jsPDF();

    // Set the title
    doc.setFontSize(24);
    doc.setTextColor(244, 164, 96); // A nice orange color
    doc.text(recipe.name, 105, 20, null, null, 'center');

    // Add the image
    try {
        const imgData = getBase64Image(recipe.image);
        doc.addImage(imgData, 'JPEG', 15, 30, 180, 100);
    } catch (error) {
        console.error('Error adding image to PDF:', error);
    }

    // Add ingredients
    doc.setFontSize(16);
    doc.setTextColor(0, 0, 0);
    doc.text('Ingredients:', 15, 140);

    doc.autoTable({
        startY: 145,
        head: [['Ingredients']],
        body: recipe.ingredients.map(ing => [ing]),
        theme: 'striped',
        headStyles: { fillColor: [244, 164, 96], textColor: 255 },
        margin: { left: 15, right: 15 },
    });

    // Add instructions
    let finalY = doc.lastAutoTable.finalY || 145;
    doc.setFontSize(16);
    doc.text('Instructions:', 15, finalY + 10);

    doc.autoTable({
        startY: finalY + 15,
        head: [['Step', 'Instruction']],
        body: recipe.instructions.map((inst, index) => [index + 1, inst]),
        theme: 'striped',
        headStyles: { fillColor: [244, 164, 96], textColor: 255 },
        margin: { left: 15, right: 15 },
    });

    doc.save(`${recipe.name}.pdf`);
}

function getBase64Image(imgUrl) {
    const img = new Image();
    img.crossOrigin = 'Anonymous';
    img.src = imgUrl;
    const canvas = document.createElement('canvas');
    canvas.width = img.width;
    canvas.height = img.height;
    const ctx = canvas.getContext('2d');
    ctx.drawImage(img, 0, 0);
    return canvas.toDataURL('image/jpeg');
}

document.addEventListener('DOMContentLoaded', () => {
    const recipesSection = document.getElementById('recipes');
    nigerianRecipes.forEach(recipe => {
        const recipeCard = generateRecipeHTML(recipe);
        recipesSection.appendChild(recipeCard);

        const viewRecipeBtn = recipeCard.querySelector('.view-recipe-btn');
        const recipeDetails = recipeCard.querySelector('.recipe-details');

        viewRecipeBtn.addEventListener('click', () => {
            if (recipeDetails.style.display === 'none') {
                recipeDetails.style.display = 'block';
                viewRecipeBtn.textContent = 'Hide Recipe';
            } else {
                recipeDetails.style.display = 'none';
                viewRecipeBtn.textContent = 'View Recipe';
            }
        });
    });
});